<?xml version="1.0"?>
<dialects>
    <dialect type="CALCITEAVATICA">
        <procedure name="Q1">
            <statement name="query_stmt">
                SELECT
                "l_returnflag",
                "l_linestatus",
                SUM("l_quantity") AS sum_qty,
                SUM("l_extendedprice") AS sum_base_price,
                SUM("l_extendedprice" * (1 - "l_discount")) AS sum_disc_price,
                SUM("l_extendedprice" * (1 - "l_discount") * (1 + "l_tax")) AS sum_charge,
                AVG("l_quantity") AS avg_qty,
                AVG("l_extendedprice") AS avg_price,
                AVG("l_discount") AS avg_disc,
                COUNT(*) AS count_order
                FROM
                "benchbase"."lineitem"
                WHERE
                "l_shipdate" &lt;= DATE '1998-12-01' - INTERVAL (CAST (? AS VARCHAR)) DAY
                GROUP BY
                "l_returnflag",
                "l_linestatus"
                ORDER BY
                "l_returnflag",
                "l_linestatus"
            </statement>
        </procedure>

        <procedure name="Q2">
            <statement name="query_stmt">
                SELECT
                "s_acctbal",
                "s_name",
                "n_name",
                "p_partkey",
                "p_mfgr",
                "s_address",
                "s_phone",
                "s_comment"
                FROM
                "benchbase"."part",
                "benchbase"."supplier",
                "benchbase"."partsupp",
                "benchbase"."nation",
                "benchbase"."region"
                WHERE
                "p_partkey" = "ps_partkey"
                AND "s_suppkey" = "ps_suppkey"
                AND "p_size" = (CAST (? AS INT))
                AND "p_type" LIKE (CAST (? AS VARCHAR))
                AND "s_nationkey" = "n_nationkey"
                AND "n_regionkey" = "r_regionkey"
                AND "r_name" = (CAST (? AS VARCHAR))
                AND "ps_supplycost" =
                (
                SELECT
                MIN("ps_supplycost")
                FROM
                "benchbase"."partsupp",
                "benchbase"."supplier",
                "benchbase"."nation",
                "benchbase"."region"
                WHERE
                "p_partkey" = "ps_partkey"
                AND "s_suppkey" = "ps_suppkey"
                AND "s_nationkey" = "n_nationkey"
                AND "n_regionkey" = "r_regionkey"
                AND "r_name" = (CAST (? AS VARCHAR))
                )
                ORDER BY
                "s_acctbal" DESC,
                "n_name",
                "s_name",
                "p_partkey" LIMIT 100
            </statement>
        </procedure>

        <procedure name="Q3">
            <statement name="query_stmt">
                SELECT ?, ?, ?
            </statement>
        </procedure>

        <procedure name="Q4">
            <statement name="query_stmt">
                SELECT ?, ?
            </statement>
        </procedure>

        <procedure name="Q5">
            <statement name="query_stmt">
                SELECT ?, ?, ?
            </statement>
        </procedure>

        <procedure name="Q6">
            <statement name="query_stmt">
                SELECT
                SUM("l_extendedprice" * "l_discount") AS revenue
                FROM
                "benchbase"."lineitem"
                WHERE
                "l_shipdate" &gt;= DATE ?
                AND "l_shipdate" &lt; DATE ? + INTERVAL '1' YEAR
                AND "l_discount" BETWEEN ? - 0.01 AND ? + 0.01
                AND "l_quantity" &lt; ?
            </statement>
        </procedure>

        <procedure name="Q7">
            <statement name="query_stmt">
                SELECT ?, ?, ?, ?
            </statement>
        </procedure>

        <procedure name="Q8">
            <statement name="query_stmt">
                SELECT ?, ?, ?
            </statement>
        </procedure>

        <procedure name="Q9">
            <statement name="query_stmt">
                SELECT ?
            </statement>
        </procedure>

        <procedure name="Q10">
            <statement name="query_stmt">
                SELECT ?, ?
            </statement>
        </procedure>

        <procedure name="Q11">
            <statement name="query_stmt">
                SELECT ?, ?, ?
            </statement>
        </procedure>

        <procedure name="Q12">
            <statement name="query_stmt">
                SELECT ?, ?, ?, ?
            </statement>
        </procedure>

        <procedure name="Q13">
            <statement name="query_stmt">
                SELECT ?
            </statement>
        </procedure>

        <procedure name="Q14">
            <statement name="query_stmt">
                SELECT
                100.00 * SUM(
                CASE
                WHEN
                "p_type" LIKE 'PROMO%'
                THEN
                "l_extendedprice" * (1 - "l_discount")
                ELSE
                0
                END
                ) / SUM("l_extendedprice" * (1 - "l_discount")) AS promo_revenue
                FROM
                "benchbase"."lineitem", "benchbase"."part"
                WHERE
                "l_partkey" = "p_partkey"
                AND "l_shipdate" &gt;= DATE ?
                AND "l_shipdate" &lt; DATE ? + INTERVAL '1' MONTH
            </statement>
        </procedure>

        <procedure name="Q15">
            <statement name="query_stmt">
                SELECT true
            </statement>
            <statement name="createview_stmt">
                SELECT true
            </statement>
            <statement name="dropview_stmt">
                SELECT true
            </statement>
        </procedure>

        <procedure name="Q16">
            <statement name="query_stmt">
                SELECT ?, ?, ?, ?, ?, ?, ?, ?, ?, ?
            </statement>
        </procedure>

        <procedure name="Q17">
            <statement name="query_stmt">
                SELECT
                SUM("l_extendedprice") / 7.0 AS avg_yearly
                FROM
                "benchbase"."lineitem",
                "benchbase"."part"
                WHERE
                "p_partkey" = "l_partkey"
                AND "p_brand" = ?
                AND "p_container" = ?
                AND "l_quantity" &lt; (
                SELECT
                0.2 * AVG("l_quantity")
                FROM
                "benchbase"."lineitem"
                WHERE
                "l_partkey" = "p_partkey" )
            </statement>
        </procedure>

        <procedure name="Q18">
            <statement name="query_stmt">
                SELECT
                "c_name",
                "c_custkey",
                "o_orderkey",
                "o_orderdate",
                "o_totalprice",
                SUM("l_quantity")
                FROM
                "benchbase"."customer",
                "benchbase"."orders",
                "benchbase"."lineitem"
                WHERE
                "o_orderkey" IN
                (
                SELECT
                "l_orderkey"
                FROM
                "benchbase"."lineitem"
                GROUP BY
                "l_orderkey"
                HAVING
                SUM("l_quantity") &gt; ?
                )
                AND "c_custkey" = "o_custkey"
                AND "o_orderkey" = "l_orderkey"
                GROUP BY
                "c_name",
                "c_custkey",
                "o_orderkey",
                "o_orderdate",
                "o_totalprice"
                ORDER BY
                "o_totalprice" DESC,
                "o_orderdate" LIMIT 100
            </statement>
        </procedure>

        <procedure name="Q19">
            <statement name="query_stmt">
                SELECT
                SUM("l_extendedprice"* (1 - "l_discount")) AS revenue
                FROM
                "benchbase"."lineitem",
                "benchbase"."part"
                WHERE
                (
                "p_partkey" = "l_partkey"
                AND "p_brand" = ?
                AND "p_container" IN ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG')
                AND "l_quantity" &gt;= ?
                AND "l_quantity" &lt;= ? + 10
                AND "p_size" BETWEEN 1 AND 5
                AND "l_shipmode" IN ('AIR', 'AIR REG')
                AND "l_shipinstruct" = 'DELIVER IN PERSON'
                )
                OR
                (
                "p_partkey" = "l_partkey"
                AND "p_brand" = ?
                AND "p_container" IN ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK')
                AND "l_quantity" &gt;= ?
                AND "l_quantity" &lt;= ? + 10
                AND "p_size" BETWEEN 1 AND 10
                AND "l_shipmode" IN ('AIR', 'AIR REG')
                AND "l_shipinstruct" = 'DELIVER IN PERSON'
                )
                OR
                (
                "p_partkey" = "l_partkey"
                AND "p_brand" = ?
                AND "p_container" IN ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG')
                AND "l_quantity" &gt;= ?
                AND "l_quantity" &lt;= ? + 10
                AND "p_size" BETWEEN 1 AND 15
                AND "l_shipmode" IN ('AIR', 'AIR REG')
                AND "l_shipinstruct" = 'DELIVER IN PERSON'
                )
            </statement>
        </procedure>

        <procedure name="Q20">
            <statement name="query_stmt">
                SELECT
                "s_name",
                "s_address"
                FROM
                "benchbase"."supplier",
                "benchbase"."nation"
                WHERE
                "s_suppkey" IN
                (
                SELECT
                "ps_suppkey"
                FROM
                "benchbase"."partsupp"
                WHERE
                "ps_partkey" IN
                (
                SELECT
                "p_partkey"
                FROM
                "benchbase"."part"
                WHERE
                "p_name" LIKE ?
                )
                AND "ps_availqty" &gt; (
                SELECT
                0.5 * SUM("l_quantity")
                FROM
                "benchbase"."lineitem"
                WHERE
                "l_partkey" = "ps_partkey"
                AND "l_suppkey" = "ps_suppkey"
                AND "l_shipdate" &gt;= DATE ?
                AND "l_shipdate" &lt; DATE ? + INTERVAL '1' YEAR )
                )
                AND "s_nationkey" = "n_nationkey"
                AND "n_name" = ?
                ORDER BY
                "s_name"
            </statement>
        </procedure>

        <procedure name="Q21">
            <statement name="query_stmt">
                SELECT ?
            </statement>
        </procedure>

        <procedure name="Q22">
            <statement name="query_stmt">
                SELECT ?, ?, ?, ?, ?, ?, ?, ? , ?, ?, ?, ?, ?, ?
            </statement>
        </procedure>

    </dialect>
</dialects>
